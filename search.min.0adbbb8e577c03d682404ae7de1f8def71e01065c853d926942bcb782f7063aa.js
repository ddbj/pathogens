document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("search-input"),e=document.getElementById("search-results");function s(e,t){let n;return(...s)=>{clearTimeout(n),n=setTimeout(()=>e(...s),t)}}let n=null;fetch("/search/index.json").then(e=>e.json()).then(e=>{n=new Fuse(e,{keys:[{name:"permalink",weight:.4},{name:"title",weight:.3},{name:"tags",weight:.2},{name:"summary",weight:.1}],threshold:.2,useExtendedSearch:!0,ignoreLocation:!0,includeScore:!0})}).catch(t=>{console.error("Error fetching search index:",t),e.innerHTML='<p class="text-danger">Failed to load search results. Please try again later.</p>'}),t.addEventListener("input",s(()=>{if(!n){e.innerHTML='<p class="text-muted">Initializing search...</p>';return}const s=t.value.trim();o(s)},300));function o(t){if(e.innerHTML="",t){let s=n.search(t);if(s.length===0)e.innerHTML='<p class="text-muted">No results found.</p>';else{const n=document.createDocumentFragment(),o=t.toLowerCase();s.forEach(({item:e})=>{const s=document.createElement("div");s.classList.add("mb-4","pb-3","border-bottom");const o=e.title.replace(new RegExp(`(${t})`,"gi"),e=>`<mark>${e}</mark>`);s.innerHTML=`
            <span class="mb-1">
              <a href="${e.permalink}">${o}</a>
            </span>
          `,n.appendChild(s)}),e.appendChild(n)}}else e.innerHTML='<p class="text-muted">Start typing to see results ...</p>'}function i(e,t){const n=t.toLowerCase();return["permalink","title","summary"].some(t=>e[t]?.toLowerCase()===n)||e.tags?.some(e=>e.toLowerCase()===n)}function a(e){const s=[{key:"permalink",weight:.4},{key:"title",weight:.3},{key:"tags",weight:.2},{key:"summary",weight:.1}],n=t.value.toLowerCase();return s.reduce((t,{key:s,weight:o})=>{if(s==="tags"){if(e.tags?.some(e=>e.toLowerCase().includes(n)))return Math.min(t,1/o)}else if(e[s]?.toLowerCase().includes(n))return Math.min(t,1/o);return t},Number.MAX_VALUE)}})